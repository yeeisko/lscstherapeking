<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Upload and Zip Files</title>
</head>
<body>
  <h2>Upload Files and Create Zip</h2>
  <form id="zipForm">
    <label for="zipName">Zip filename (without .zip):</label><br />
    <input type="text" id="zipName" name="zipName" value="adhoc" required /><br /><br />
    <label for="files">Select files:</label><br />
    <input type="file" id="files" name="files" multiple required /><br /><br />
    <button type="submit">Create Zip</button>
  </form>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script>
    const form = document.getElementById('zipForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const zipName = document.getElementById('zipName').value.trim() || 'adhoc';
      const inputFiles = document.getElementById('files').files;
      if (inputFiles.length === 0) {
        alert('Please select files to zip.');
        return;
      }

      const zip = new JSZip();

      for (const file of inputFiles) {
        // Read file as array buffer
        const content = await file.arrayBuffer();
        zip.file(file.name, content);
      }

      const blob = await zip.generateAsync({ type: 'blob' });

      // Create a download link
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = zipName + '.zip';
      link.click();

      // Cleanup
      URL.revokeObjectURL(link.href);
    });
  </script>
</body>
</html>
