<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Certificate and Private Key Checker</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 2em 3em;
    max-width: 700px;
    color: #333;
  }
  label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.4em;
    color: #555;
  }
  textarea {
    width: 100%;
    height: 400px;  /* increased height */
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 16px;  /* increased padding */
    font-family: monospace;
    font-size: 1.3rem;  /* increased font size */
    resize: vertical;
    box-sizing: border-box;
    margin-bottom: 2.5em;
  }
  button {
    background-color: #2f80ed;
    color: white;
    border: none;
    padding: 1em 2em;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover {
    background-color: #1366d6;
  }
  #result {
    margin-top: 1.5em;
    font-weight: bold;
  }
</style>
</head>
<body>

<label for="pemInput">Enter your Certificate</label>
<textarea id="pemInput" placeholder="-----BEGIN CERTIFICATE-----&#10;...&#10;-----END CERTIFICATE-----"></textarea>

<label for="keyInput">Enter your Private Key</label>
<textarea id="keyInput" placeholder="-----BEGIN PRIVATE KEY-----&#10;...&#10;-----END PRIVATE KEY-----"></textarea>

<button id="checkBtn">Check Match</button>

<div id="result"></div>

<script src="https://cdn.jsdelivr.net/npm/node-forge@1.3.1/dist/forge.min.js"></script>
<script>
  function getPublicKeyFromCert(pemCert) {
    const forge = window.forge;
    return forge.pki.certificateFromPem(pemCert).publicKey;
  }

  function getPublicKeyFromPrivateKey(pemKey) {
    const forge = window.forge;
    try {
      const privKey = forge.pki.privateKeyFromPem(pemKey);
      return privKey.publicKey || forge.pki.setRsaPublicKey(privKey.n, privKey.e);
    } catch {
      const privateKey = forge.pki.decryptRsaPrivateKey(pemKey, '');
      if (!privateKey) throw new Error('Invalid private key format');
      return forge.pki.setRsaPublicKey(privateKey.n, privateKey.e);
    }
  }

  function getPublicKeyFingerprint(publicKey) {
    const forge = window.forge;
    const asn1 = forge.pki.publicKeyToAsn1(publicKey);
    const der = forge.asn1.toDer(asn1).getBytes();
    const md = forge.md.sha256.create();
    md.update(der);
    return md.digest().toHex();
  }

  function checkMatch() {
    const pem = document.getElementById('pemInput').value.trim();
    const key = document.getElementById('keyInput').value.trim();
    const resultDiv = document.getElementById('result');
    resultDiv.textContent = '';
    resultDiv.style.color = 'black';

    if (!pem || !key) {
      resultDiv.textContent = 'Please provide both the certificate and private key.';
      resultDiv.style.color = 'red';
      return;
    }

    try {
      const certPubKey = getPublicKeyFromCert(pem);
      const privPubKey = getPublicKeyFromPrivateKey(key);

      const certFingerprint = getPublicKeyFingerprint(certPubKey);
      const privFingerprint = getPublicKeyFingerprint(privPubKey);

      if (certFingerprint === privFingerprint) {
        resultDiv.textContent = '✅ The private key matches the certificate.';
        resultDiv.style.color = 'green';
      } else {
        resultDiv.textContent = '❌ The private key does NOT match the certificate.';
        resultDiv.style.color = 'red';
      }
    } catch (e) {
      resultDiv.textContent = 'Error parsing keys: ' + e.message;
      resultDiv.style.color = 'red';
    }
  }

  document.getElementById('checkBtn').addEventListener('click', checkMatch);
&lt;/script>

</body>
</html>
